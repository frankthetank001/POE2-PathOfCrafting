.crafting-simulator {
  width: 100%;
}

.item-paste-section {
  background: #2a2a2a;
  border: 2px solid #444;
  border-radius: 8px;
  margin-bottom: 1rem;
  overflow: hidden;
}

.paste-header {
  padding: 1rem 1.5rem;
  cursor: pointer;
  user-select: none;
  background: #2a2a2a;
  transition: background 0.2s;
}

.paste-header:hover {
  background: #333;
}

.paste-header h3 {
  margin: 0;
  font-size: 1.1rem;
  color: #d4af37;
}

.paste-content {
  padding: 1.5rem;
  border-top: 1px solid #444;
}

.paste-instructions {
  color: #aaa;
  margin-bottom: 1rem;
  font-size: 0.95rem;
}

.item-paste-textarea {
  width: 100%;
  min-height: 200px;
  padding: 1rem;
  background: #0a0a0a;
  border: 1px solid #444;
  border-radius: 6px;
  color: #fff;
  font-family: 'Courier New', monospace;
  font-size: 0.85rem;
  resize: vertical;
  margin-bottom: 1rem;
  box-sizing: border-box;
}

.item-paste-textarea:focus {
  outline: none;
  border-color: #d4af37;
}

.paste-actions {
  display: flex;
  gap: 0.75rem;
  margin-bottom: 1rem;
}

.paste-button {
  padding: 0.75rem 1.5rem;
  background: #4a9eff;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 500;
  font-size: 0.95rem;
  transition: all 0.2s;
}

.paste-button:hover:not(:disabled) {
  background: #5fadff;
  transform: translateY(-2px);
}

.paste-button:disabled {
  background: #333;
  cursor: not-allowed;
  opacity: 0.5;
}

.clear-button {
  padding: 0.75rem 1.5rem;
  background: #444;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 500;
  font-size: 0.95rem;
  transition: all 0.2s;
}

.clear-button:hover:not(:disabled) {
  background: #555;
}

.clear-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.paste-message {
  padding: 0.75rem;
  border-radius: 6px;
  font-size: 0.95rem;
}

.paste-message.success {
  background: rgba(0, 255, 0, 0.1);
  color: #00ff88;
  border: 1px solid #00ff00;
}

.paste-message.error {
  background: rgba(255, 0, 0, 0.1);
  color: #ff6666;
  border: 1px solid #ff4444;
}

.item-base-selector {
  background: #2a2a2a;
  border: 2px solid #444;
  border-radius: 8px;
  padding: 0.75rem 1rem;
  margin-bottom: 1rem;
}

.item-base-selector h3 {
  color: #d4af37;
  font-size: 1.1rem;
  margin: 0 0 1rem 0;
}

.base-selector-row {
  display: flex;
  align-items: center;
  gap: 1.5rem;
  flex-wrap: wrap;
}

.slot-selector,
.base-selector,
.ilvl-selector {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.slot-selector label,
.base-selector label,
.ilvl-selector label {
  color: #888;
  font-size: 0.9rem;
  min-width: 40px;
}

.slot-selector select,
.base-selector select {
  padding: 0.5rem;
  background: #1a1a1a;
  border: 2px solid #444;
  border-radius: 6px;
  color: #e0e0e0;
  font-size: 0.9rem;
  cursor: pointer;
  min-width: 150px;
}

.base-selector select {
  min-width: 250px;
}

.slot-selector select:focus,
.base-selector select:focus {
  outline: none;
  border-color: #d4af37;
}

.ilvl-selector label {
  min-width: 80px;
}

.ilvl-selector input {
  padding: 0.5rem;
  background: #1a1a1a;
  border: 2px solid #444;
  border-radius: 6px;
  color: #e0e0e0;
  font-size: 0.9rem;
  width: 80px;
  text-align: center;
}

.ilvl-selector input:focus {
  outline: none;
  border-color: #d4af37;
}

.ilvl-selector input::-webkit-outer-spin-button,
.ilvl-selector input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

.base-info {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  margin-left: 1rem;
  padding: 0.5rem 1rem;
  background: rgba(212, 175, 55, 0.1);
  border: 1px solid rgba(212, 175, 55, 0.3);
  border-radius: 6px;
}

.base-category {
  color: #88ccff;
  font-size: 0.85rem;
  font-weight: 500;
}

.base-ilvl {
  color: #d4af37;
  font-size: 0.85rem;
  font-weight: 600;
}

.base-requirements,
.base-slot {
  color: #888;
  font-size: 0.8rem;
}

.currency-bar {
  background: #2a2a2a;
  border: 2px solid #444;
  border-radius: 8px;
  padding: 1rem 1.5rem;
  margin-bottom: 1.5rem;
}

.currency-bar-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}

.currency-bar-header h3 {
  color: #d4af37;
  font-size: 1.1rem;
  margin: 0;
}

.undo-button-top {
  padding: 0.4rem 1rem;
  background: #444;
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.2s;
}

.undo-button-top:hover:not(:disabled) {
  background: #555;
}

.undo-button-top:disabled {
  opacity: 0.3;
  cursor: not-allowed;
}

.currency-buttons-row {
  display: flex;
  gap: 0.75rem;
  flex-wrap: wrap;
}

.currency-button-compact {
  padding: 0.6rem 1rem;
  background: #8b4513;
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 0.9rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
}

.currency-button-compact:hover:not(:disabled) {
  background: #a0522d;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(139, 69, 19, 0.4);
}

.currency-button-compact:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.no-currencies-bar {
  color: #666;
  font-size: 0.9rem;
  margin: 0;
}

.message-compact {
  margin-top: 1rem;
  padding: 0.75rem;
  border-radius: 6px;
  font-weight: 500;
  font-size: 0.9rem;
}

.message-compact.success {
  background: rgba(0, 255, 0, 0.1);
  border: 1px solid #00ff00;
  color: #00ff88;
}

.message-compact.error {
  background: rgba(255, 0, 0, 0.1);
  border: 1px solid #ff4444;
  color: #ff6666;
}

.message-compact.info {
  background: rgba(100, 149, 237, 0.1);
  border: 1px solid #6495ed;
  color: #87ceeb;
}

.simulator-layout {
  display: flex;
  flex-direction: row;
  gap: 0;
  max-width: 100%;
  min-height: 400px;
  position: relative;
}

.simulator-layout.mods-collapsed {
  gap: 0;
}

.resize-handle {
  width: 8px;
  cursor: col-resize;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  position: relative;
  z-index: 10;
  user-select: none;
}

.resize-handle:hover .resize-line {
  background: #d4af37;
  width: 2px;
}

.resize-line {
  width: 1px;
  height: 100%;
  background: #333;
  transition: all 0.2s;
  border-radius: 1px;
}

/* Vertical resize handles */
.resize-handle-vertical {
  height: 8px;
  width: 100%;
  cursor: row-resize;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  position: relative;
  z-index: 10;
  user-select: none;
  margin: 4px 0;
}

.resize-handle-vertical:hover .resize-line-vertical {
  background: #d4af37;
  height: 2px;
}

.resize-line-vertical {
  height: 1px;
  width: 100%;
  background: #333;
  transition: all 0.2s;
  border-radius: 1px;
}

.mods-pool-panel,
.center-panel {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.center-panel {
  flex: 1;
  min-width: 400px;
  margin-left: 1rem;
}

.mods-pool-panel {
  flex-shrink: 0;
  transition: width 0.3s ease;
}

.simulator-layout.mods-collapsed .mods-pool-panel {
  width: 60px !important;
  min-width: 60px;
  padding: 1rem 0.5rem;
}

.simulator-layout.mods-collapsed .center-panel {
  margin-left: 0;
}

.item-display {
  background: #2a2a2a;
  border: 2px solid #444;
  border-radius: 8px;
  padding: 1rem;
}

.item-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 1rem;
  margin-bottom: 1rem;
  border-bottom: 2px solid #444;
}

.item-name {
  font-size: 1.5rem;
  font-weight: bold;
  margin: 0;
}

.item-rarity-badge {
  padding: 0.25rem 0.75rem;
  background: rgba(212, 175, 55, 0.2);
  border-radius: 4px;
  font-size: 0.9rem;
  color: #d4af37;
}

.item-details {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.detail-row {
  display: flex;
  justify-content: space-between;
}

.detail-label {
  color: #888;
}

.detail-value {
  color: #e0e0e0;
  font-weight: bold;
}

/* Stats display */
.stats-section {
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px solid #444;
}

.stats-title {
  color: #d4af37;
  font-size: 1rem;
  margin: 0 0 0.75rem 0;
  font-weight: 600;
}

.stat-row {
  display: flex;
  justify-content: space-between;
  margin-bottom: 0.5rem;
}

.stat-label {
  color: #ccc;
  font-size: 0.9rem;
}

.stat-value {
  color: #fff;
  font-weight: 600;
  font-size: 0.9rem;
}

.mods-section {
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px solid #444;
}

.mods-title {
  color: #d4af37;
  font-size: 1rem;
  margin-bottom: 0.5rem;
}

.mod-line {
  padding: 0.5rem;
  margin: 0.25rem 0;
  border-radius: 4px;
  font-size: 0.95rem;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.mod-stat {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.mod-with-info {
  cursor: help;
  flex: 1;
}

.mod-range {
  color: #888;
  font-size: 0.85rem;
  margin-left: 0.25rem;
}

.mod-metadata {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  flex-wrap: wrap;
}

.mod-line.implicit {
  color: #8888ff;
  background: rgba(136, 136, 255, 0.05);
}

.mod-line.prefix {
  color: #88ccff;
  background: rgba(136, 204, 255, 0.05);
}

.mod-line.suffix {
  color: #ffaa44;
  background: rgba(255, 170, 68, 0.05);
}

.mod-tier {
  font-size: 0.8rem;
  color: #888;
  padding: 0.1rem 0.4rem;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 3px;
}

.mod-name {
  font-size: 0.75rem;
  color: #666;
  font-style: italic;
}

.mod-tags {
  display: flex;
  gap: 0.25rem;
}

.mod-tag {
  font-size: 0.65rem;
  padding: 0.1rem 0.4rem;
  background: rgba(100, 149, 237, 0.2);
  border: 1px solid rgba(100, 149, 237, 0.4);
  border-radius: 3px;
  color: #88b3ff;
  font-style: normal;
}

.empty-mods {
  text-align: center;
  padding: 2rem;
  color: #666;
}

.corrupted-tag {
  margin-top: 1rem;
  padding: 0.5rem;
  text-align: center;
  background: rgba(255, 0, 0, 0.2);
  border: 1px solid #ff4444;
  border-radius: 4px;
  color: #ff6666;
  font-weight: bold;
}

.reset-button {
  padding: 0.5rem;
  background: #444;
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.2s;
}

.reset-button:hover {
  background: #555;
}

.currency-tracker {
  background: #2a2a2a;
  border: 2px solid #444;
  border-radius: 8px;
  padding: 1rem;
}

.currency-tracker h3 {
  color: #d4af37;
  font-size: 1.2rem;
  margin-bottom: 1rem;
}

.currency-spent-list {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.currency-spent-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.5rem;
  background: #1a1a1a;
  border-radius: 4px;
}

.currency-spent-name {
  color: #d4af37;
  font-weight: 500;
}

.currency-spent-count {
  color: #e0e0e0;
  font-weight: bold;
  font-size: 1.1rem;
}

.currency-buttons-section,
.history-section,
.info-section {
  background: #2a2a2a;
  border: 2px solid #444;
  border-radius: 8px;
  padding: 1rem;
}

.currency-buttons-section h3,
.history-section h3,
.info-section h3 {
  color: #d4af37;
  font-size: 1.2rem;
  margin-bottom: 1rem;
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}

.section-header h3 {
  margin: 0;
}

.currency-buttons-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  margin-bottom: 1rem;
}

.currency-button {
  padding: 0.75rem 1rem;
  background: #8b4513;
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 0.95rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
}

.currency-button:hover:not(:disabled) {
  background: #a0522d;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(139, 69, 19, 0.4);
}

.currency-button:active:not(:disabled) {
  transform: translateY(0);
}

.currency-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.undo-button {
  padding: 0.5rem 1rem;
  background: #444;
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.2s;
}

.undo-button:hover:not(:disabled) {
  background: #555;
}

.undo-button:disabled {
  opacity: 0.3;
  cursor: not-allowed;
}

.currency-select {
  width: 100%;
  padding: 0.75rem;
  background: #1a1a1a;
  border: 2px solid #444;
  border-radius: 8px;
  color: #e0e0e0;
  font-size: 1rem;
  margin-bottom: 1rem;
  cursor: pointer;
}

.currency-select:focus {
  outline: none;
  border-color: #d4af37;
}

.currency-select option:disabled {
  color: #666;
}

.craft-button {
  width: 100%;
  padding: 1rem;
  background: #8b4513;
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 1.1rem;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.2s;
}

.craft-button:hover:not(:disabled) {
  background: #a0522d;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(139, 69, 19, 0.4);
}

.craft-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.message {
  margin-top: 1rem;
  padding: 1rem;
  border-radius: 8px;
  font-weight: bold;
}

.message.success {
  background: rgba(0, 255, 0, 0.1);
  border: 1px solid #00ff00;
  color: #00ff88;
}

.message.error {
  background: rgba(255, 0, 0, 0.1);
  border: 1px solid #ff4444;
  color: #ff6666;
}

.message.info {
  background: rgba(100, 149, 237, 0.1);
  border: 1px solid #6495ed;
  color: #87ceeb;
}

.history-list {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  max-height: 300px;
  overflow-y: auto;
}

.history-entry {
  display: flex;
  gap: 0.5rem;
  padding: 0.5rem;
  background: #1a1a1a;
  border-radius: 4px;
}

.history-number {
  color: #d4af37;
  font-weight: bold;
  min-width: 2rem;
}

.history-text {
  color: #c0c0c0;
}

.empty-history,
.no-currencies {
  text-align: center;
  padding: 1rem;
  color: #666;
}

.available-currencies {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.currency-chip {
  padding: 0.5rem 1rem;
  background: rgba(139, 69, 19, 0.2);
  border: 1px solid #8b4513;
  border-radius: 4px;
  color: #d4af37;
  font-size: 0.9rem;
}

.mods-pool-panel {
  background: #2a2a2a;
  border: 2px solid #444;
  border-radius: 8px;
  padding: 1.5rem;
  height: calc(100vh - 220px);
  max-height: calc(100vh - 220px);
  min-height: 500px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  box-sizing: border-box;
  min-width: 300px;
  max-width: 80vw;
}

.mods-pool-header {
  margin-bottom: 1rem;
}

.mods-pool-title-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.5rem;
}

.mods-pool-header h3 {
  color: #d4af37;
  font-size: 1.2rem;
  margin: 0;
}

.collapse-button {
  padding: 0.4rem 0.6rem;
  background: #444;
  color: white;
  border: none;
  border-radius: 4px;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.2s;
  min-width: 32px;
}

.collapse-button:hover {
  background: #555;
}

.simulator-layout.mods-collapsed .mods-pool-header h3 {
  display: none;
}

.simulator-layout.mods-collapsed .collapse-button {
  width: 100%;
}

.mods-pool-stats {
  display: flex;
  gap: 0.5rem;
}

.stat-badge {
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: 0.85rem;
  font-weight: 500;
}

.prefix-badge {
  background: rgba(136, 204, 255, 0.2);
  color: #88ccff;
  border: 1px solid rgba(136, 204, 255, 0.4);
}

.suffix-badge {
  background: rgba(255, 170, 68, 0.2);
  color: #ffaa44;
  border: 1px solid rgba(255, 170, 68, 0.4);
}

.mods-pool-filters {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  margin-bottom: 1rem;
}

.search-input {
  width: 100%;
  padding: 0.5rem;
  background: #1a1a1a;
  border: 2px solid #444;
  border-radius: 6px;
  color: #e0e0e0;
  font-size: 0.95rem;
}

.search-input:focus {
  outline: none;
  border-color: #d4af37;
}

.mods-pool-columns {
  display: flex;
  gap: 1rem;
  flex: 1 1 auto;
  min-height: 0;
}

/* Special mods (essence/desecrated) sections stack vertically */
.special-mods-section {
  margin-top: 1rem;
  width: 100%;
  max-height: 300px;
  overflow: hidden;
  flex-shrink: 0;
}

/* Special mods (essence/desecrated) columns layout */
.special-mods-columns {
  display: flex;
  gap: 1rem;
  margin-top: 0.5rem;
  height: 100%;
  overflow: hidden;
}

.special-mods-column {
  display: flex;
  flex-direction: column;
  overflow: hidden;
  min-height: 0;
  flex: 1;
}

.special-mods-column .mods-pool-list {
  flex: 1 1 auto;
  overflow-y: auto;
  max-height: 300px;
}

.special-section-title {
  color: #d4af37;
  font-size: 1.1rem;
  font-weight: 600;
  margin: 0 0 0.75rem 0;
  text-align: center;
}

.special-column-title {
  color: #d4af37;
  font-size: 1rem;
  font-weight: 500;
  margin: 0 0 0.5rem 0;
  padding: 0.5rem;
  background: #1a1a1a;
  border-radius: 4px;
  text-align: center;
}

.mods-pool-column {
  display: flex;
  flex-direction: column;
  min-height: 0;
  width: 100%;
  flex: 1 1 50%;
}

.column-title {
  color: #d4af37;
  font-size: 1rem;
  margin: 0 0 0.75rem 0;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid #444;
}

.mods-pool-list {
  flex: 1 1 auto;
  overflow-y: auto;
  display: block;
  padding-right: 0.25rem;
  min-height: 0;
}

.mods-pool-list::-webkit-scrollbar {
  width: 6px;
}

.mods-pool-list::-webkit-scrollbar-track {
  background: #1a1a1a;
  border-radius: 3px;
}

.mods-pool-list::-webkit-scrollbar-thumb {
  background: #444;
  border-radius: 3px;
}

.mods-pool-list::-webkit-scrollbar-thumb:hover {
  background: #555;
}

/* Main panel scrollbar styling */
.mods-pool-panel::-webkit-scrollbar {
  width: 8px;
}

.mods-pool-panel::-webkit-scrollbar-track {
  background: #1a1a1a;
  border-radius: 4px;
}

.mods-pool-panel::-webkit-scrollbar-thumb {
  background: #444;
  border-radius: 4px;
}

.mods-pool-panel::-webkit-scrollbar-thumb:hover {
  background: #555;
}

.pool-mod-group {
  background: #1a1a1a;
  border-radius: 6px;
  margin-bottom: 0.5rem;
  overflow: hidden;
  width: 100%;
  box-sizing: border-box;
}

.pool-mod-group-header {
  padding: 0.5rem 0.75rem;
  border-left: 3px solid transparent;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  justify-content: space-between;
  align-items: center;
  min-height: 40px;
  width: 100%;
}

.pool-mod-group-header.compact-single-line {
  padding: 0.4rem 0.75rem;
  min-height: 32px;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

.compact-mod-info {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.85rem;
  flex-wrap: wrap;
  width: 100%;
}

.compact-single-line .pool-mod-stat-main {
  flex: 0 0 auto;
  min-width: 0;
  font-size: 0.9rem;
  display: block;
  width: 100%;
  margin-bottom: 0.25rem;
}


/* Tag Filters in Mods Panel */
.tag-filters {
  margin-top: 0.75rem;
  padding-top: 0.75rem;
  border-top: 1px solid #444;
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 0.4rem;
}

.tag-filters-label {
  font-size: 0.85rem;
  color: #d4af37;
  font-weight: 500;
  margin-right: 0.25rem;
}

.clear-filters-btn {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid #666;
  color: #e0e0e0;
  padding: 0.25rem;
  border-radius: 50%;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-right: 0.5rem;
  width: 1.8rem;
  height: 1.8rem;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.clear-filters-btn:hover:not(.disabled) {
  background: rgba(255, 255, 255, 0.2);
  border-color: #999;
  transform: rotate(180deg);
}

.clear-filters-btn.disabled {
  opacity: 0.3;
  cursor: not-allowed;
  color: #666;
  border-color: #444;
}

.clear-filters-btn.disabled:hover {
  transform: none;
  background: rgba(255, 255, 255, 0.1);
}

/* Legend tags - bigger size for filter legend */
.legend-tag-text {
  font-size: 0.8rem;
  font-weight: 500;
  text-transform: lowercase;
  padding: 0.25rem 0.5rem;
  background: rgba(100, 149, 237, 0.15);
  border: 1px solid rgba(100, 149, 237, 0.3);
  border-radius: 12px;
  color: #88b3ff;
  line-height: 1;
  white-space: nowrap;
  cursor: pointer;
  transition: all 0.2s ease;
}

/* Enhanced color-aware hover effects */
.legend-tag-text:hover:not(.active-filter) {
  filter: brightness(1.3) saturate(1.2);
  transform: translateY(-1px);
  box-shadow: 0 0 0 1px currentColor, 0 2px 6px rgba(0, 0, 0, 0.2);
}

/* Mod tag hover effect is handled separately below for domino effect */

/* Simple active state for legend tags - solid border */
.legend-tag-text.active-filter {
  opacity: 1;
  border: 2px solid currentColor;
  background: rgba(255, 255, 255, 0.1);
}

/* Mod tag active state is handled separately below for domino effect */

/* Removed color-specific contrast rules since we no longer change colors */

/* Apply individual tag colors to legend tags */
.legend-tag-text[data-tag="life"] {
  background: rgba(255, 107, 107, 0.2);
  border-color: #ff6b6b;
  color: #ff6b6b;
}
.legend-tag-text[data-tag="mana"] {
  background: rgba(77, 171, 247, 0.2);
  border-color: #4dabf7;
  color: #4dabf7;
}
.legend-tag-text[data-tag="fire"] {
  background: rgba(255, 124, 66, 0.2);
  border-color: #ff7c42;
  color: #ff7c42;
}
.legend-tag-text[data-tag="cold"] {
  background: rgba(116, 192, 252, 0.2);
  border-color: #74c0fc;
  color: #74c0fc;
}
.legend-tag-text[data-tag="lightning"] {
  background: rgba(255, 212, 59, 0.2);
  border-color: #ffd43b;
  color: #ffd43b;
}
.legend-tag-text[data-tag="chaos"] {
  background: rgba(208, 191, 255, 0.2);
  border-color: #d0bfff;
  color: #d0bfff;
}
.legend-tag-text[data-tag="physical"] {
  background: rgba(255, 168, 168, 0.2);
  border-color: #ffa8a8;
  color: #ffa8a8;
}
.legend-tag-text[data-tag="elemental"] {
  background: rgba(140, 233, 154, 0.2);
  border-color: #8ce99a;
  color: #8ce99a;
}
.legend-tag-text[data-tag="resistance"] {
  background: rgba(140, 233, 154, 0.2);
  border-color: #8ce99a;
  color: #8ce99a;
}
.legend-tag-text[data-tag="critical"] {
  background: rgba(255, 140, 200, 0.2);
  border-color: #ff8cc8;
  color: #ff8cc8;
}
.legend-tag-text[data-tag="attack"] {
  background: rgba(255, 168, 168, 0.2);
  border-color: #ffa8a8;
  color: #ffa8a8;
}
.legend-tag-text[data-tag="speed"] {
  background: rgba(116, 192, 252, 0.2);
  border-color: #74c0fc;
  color: #74c0fc;
}
.legend-tag-text[data-tag="intelligence"] {
  background: rgba(76, 110, 245, 0.2);
  border-color: #4c6ef5;
  color: #4c6ef5;
}
.legend-tag-text[data-tag="strength"] {
  background: rgba(224, 49, 49, 0.2);
  border-color: #e03131;
  color: #e03131;
}
.legend-tag-text[data-tag="dexterity"] {
  background: rgba(55, 178, 77, 0.2);
  border-color: #37b24d;
  color: #37b24d;
}
.legend-tag-text[data-tag="minion"] {
  background: rgba(174, 62, 201, 0.2);
  border-color: #ae3ec9;
  color: #ae3ec9;
}
.legend-tag-text[data-tag="gem"] {
  background: rgba(16, 152, 173, 0.2);
  border-color: #1098ad;
  color: #1098ad;
}
.legend-tag-text[data-tag="aura"] {
  background: rgba(253, 126, 20, 0.2);
  border-color: #fd7e14;
  color: #fd7e14;
}
.legend-tag-text[data-tag="curse"] {
  background: rgba(103, 65, 217, 0.2);
  border-color: #6741d9;
  color: #6741d9;
}
.legend-tag-text[data-tag="ailment"] {
  background: rgba(247, 103, 7, 0.2);
  border-color: #f76707;
  color: #f76707;
}



._unused-tag-filter-btn[data-tag="life"] { border-color: #ff6b6b; }
._unused-tag-filter-btn[data-tag="mana"] { border-color: #4dabf7; }
._unused-tag-filter-btn[data-tag="fire"] { border-color: #ff7c42; }
._unused-tag-filter-btn[data-tag="cold"] { border-color: #74c0fc; }
._unused-tag-filter-btn[data-tag="lightning"] { border-color: #ffd43b; }
._unused-tag-filter-btn[data-tag="chaos"] { border-color: #d0bfff; }
._unused-tag-filter-btn[data-tag="resistance"] { border-color: #8ce99a; }
._unused-tag-filter-btn[data-tag="critical"] { border-color: #ff8cc8; }
._unused-tag-filter-btn[data-tag="attack"] { border-color: #ffa8a8; }
._unused-tag-filter-btn[data-tag="speed"] { border-color: #74c0fc; }
._unused-tag-filter-btn[data-tag="intelligence"] { border-color: #4c6ef5; }
._unused-tag-filter-btn[data-tag="strength"] { border-color: #e03131; }
._unused-tag-filter-btn[data-tag="dexterity"] { border-color: #37b24d; }
._unused-tag-filter-btn[data-tag="minion"] { border-color: #ae3ec9; }
._unused-tag-filter-btn[data-tag="gem"] { border-color: #1098ad; }
._unused-tag-filter-btn[data-tag="aura"] { border-color: #fd7e14; }
._unused-tag-filter-btn[data-tag="curse"] { border-color: #6741d9; }
._unused-tag-filter-btn[data-tag="ailment"] { border-color: #f76707; }

._unused-tag-filter-btn.active[data-tag="life"] { background: #ff6b6b; color: #fff; }
._unused-tag-filter-btn.active[data-tag="mana"] { background: #4dabf7; color: #fff; }
._unused-tag-filter-btn.active[data-tag="fire"] { background: #ff7c42; color: #fff; }
._unused-tag-filter-btn.active[data-tag="cold"] { background: #74c0fc; color: #fff; }
._unused-tag-filter-btn.active[data-tag="lightning"] { background: #ffd43b; color: #000; }
._unused-tag-filter-btn.active[data-tag="chaos"] { background: #d0bfff; color: #000; }
._unused-tag-filter-btn.active[data-tag="resistance"] { background: #8ce99a; color: #000; }
._unused-tag-filter-btn.active[data-tag="critical"] { background: #ff8cc8; color: #000; }
._unused-tag-filter-btn.active[data-tag="attack"] { background: #ffa8a8; color: #000; }
._unused-tag-filter-btn.active[data-tag="speed"] { background: #74c0fc; color: #fff; }
._unused-tag-filter-btn.active[data-tag="intelligence"] { background: #4c6ef5; color: #fff; }
._unused-tag-filter-btn.active[data-tag="strength"] { background: #e03131; color: #fff; }
._unused-tag-filter-btn.active[data-tag="dexterity"] { background: #37b24d; color: #fff; }
._unused-tag-filter-btn.active[data-tag="minion"] { background: #ae3ec9; color: #fff; }
._unused-tag-filter-btn.active[data-tag="gem"] { background: #1098ad; color: #fff; }
._unused-tag-filter-btn.active[data-tag="aura"] { background: #fd7e14; color: #fff; }
._unused-tag-filter-btn.active[data-tag="curse"] { background: #6741d9; color: #fff; }
._unused-tag-filter-btn.active[data-tag="ailment"] { background: #f76707; color: #fff; }

._unused-tag-filter-btn:hover:not(.active) {
  opacity: 0.8;
}

/* Grey out filtered mods */
.pool-mod-group.tag-filtered {
  opacity: 0.3;
  filter: grayscale(70%);
}

.pool-mod-group.tag-filtered .pool-mod-group-header {
  background: rgba(0, 0, 0, 0.2);
  cursor: default;
}

/* Tag Legend (keeping old styles for backward compatibility) */
.tag-legend {
  background: #2a2a2a;
  border: 2px solid #444;
  border-radius: 8px;
  padding: 1rem 1.5rem;
  margin: 1rem 0;
}

.tag-legend h4 {
  color: #d4af37;
  font-size: 1rem;
  margin: 0 0 0.75rem 0;
}

.tag-legend-items {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
}

.tag-legend-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.85rem;
  color: #e0e0e0;
}

.tag-color {
  width: 12px;
  height: 12px;
  border-radius: 2px;
  flex-shrink: 0;
}

/* Tag Colors */
.tag-color[data-tag="life"] { background: #ff6b6b; }
.tag-color[data-tag="mana"] { background: #4dabf7; }
.tag-color[data-tag="fire"] { background: #ff7c42; }
.tag-color[data-tag="cold"] { background: #74c0fc; }
.tag-color[data-tag="lightning"] { background: #ffd43b; }
.tag-color[data-tag="chaos"] { background: #d0bfff; }
.tag-color[data-tag="resistance"] { background: #8ce99a; }
.tag-color[data-tag="critical"] { background: #ff8cc8; }
.tag-color[data-tag="attack"] { background: #ffa8a8; }
.tag-color[data-tag="speed"] { background: #74c0fc; }
.tag-color[data-tag="intelligence"] { background: #4c6ef5; }
.tag-color[data-tag="strength"] { background: #e03131; }
.tag-color[data-tag="dexterity"] { background: #37b24d; }
.tag-color[data-tag="minion"] { background: #ae3ec9; }
.tag-color[data-tag="gem"] { background: #1098ad; }
.tag-color[data-tag="aura"] { background: #fd7e14; }
.tag-color[data-tag="curse"] { background: #6741d9; }
.tag-color[data-tag="ailment"] { background: #f76707; }

/* Compact tags for mods - small colored squares */
/* Mod tags displayed at end of mod bar with domino/tab stacking effect */
.mod-tags-line {
  display: inline-flex;
  flex-wrap: wrap;
  align-items: center;
  flex-shrink: 0;
  /* Remove gap to allow stacking */
  position: relative;
  max-width: fit-content;
}

.mod-tag-text {
  font-size: 0.6rem;
  font-weight: 500;
  text-transform: lowercase;
  padding: 0.15rem 0.4rem;
  background: rgba(100, 149, 237, 0.15);
  border: 1px solid rgba(100, 149, 237, 0.3);
  border-radius: 10px;
  color: #88b3ff;
  line-height: 1;
  white-space: nowrap;
  cursor: pointer;
  transition: all 0.2s ease;
}

/* Simple hover effect */
.mod-tag-text:hover:not(.active-filter) {
  filter: brightness(1.2);
}

/* Simple active state - solid border for visibility */
.mod-tag-text.active-filter {
  opacity: 1;
  border: 2px solid currentColor;
  background: rgba(255, 255, 255, 0.1);
}

/* Individual mod tag colors based on screenshot */
.mod-tag-text[data-tag="life"] {
  background: rgba(255, 107, 107, 0.2);
  border-color: #ff6b6b;
  color: #ff6b6b;
}
.mod-tag-text[data-tag="mana"] {
  background: rgba(77, 171, 247, 0.2);
  border-color: #4dabf7;
  color: #4dabf7;
}
.mod-tag-text[data-tag="fire"] {
  background: rgba(255, 124, 66, 0.2);
  border-color: #ff7c42;
  color: #ff7c42;
}
.mod-tag-text[data-tag="cold"] {
  background: rgba(116, 192, 252, 0.2);
  border-color: #74c0fc;
  color: #74c0fc;
}
.mod-tag-text[data-tag="lightning"] {
  background: rgba(255, 212, 59, 0.2);
  border-color: #ffd43b;
  color: #ffd43b;
}
.mod-tag-text[data-tag="chaos"] {
  background: rgba(208, 191, 255, 0.2);
  border-color: #d0bfff;
  color: #d0bfff;
}
.mod-tag-text[data-tag="physical"] {
  background: rgba(255, 168, 168, 0.2);
  border-color: #ffa8a8;
  color: #ffa8a8;
}
.mod-tag-text[data-tag="elemental"] {
  background: rgba(140, 233, 154, 0.2);
  border-color: #8ce99a;
  color: #8ce99a;
}
.mod-tag-text[data-tag="resistance"] {
  background: rgba(140, 233, 154, 0.2);
  border-color: #8ce99a;
  color: #8ce99a;
}
.mod-tag-text[data-tag="critical"] {
  background: rgba(255, 140, 200, 0.2);
  border-color: #ff8cc8;
  color: #ff8cc8;
}
.mod-tag-text[data-tag="attack"] {
  background: rgba(255, 168, 168, 0.2);
  border-color: #ffa8a8;
  color: #ffa8a8;
}
.mod-tag-text[data-tag="speed"] {
  background: rgba(116, 192, 252, 0.2);
  border-color: #74c0fc;
  color: #74c0fc;
}
.mod-tag-text[data-tag="intelligence"] {
  background: rgba(76, 110, 245, 0.2);
  border-color: #4c6ef5;
  color: #4c6ef5;
}
.mod-tag-text[data-tag="strength"] {
  background: rgba(224, 49, 49, 0.2);
  border-color: #e03131;
  color: #e03131;
}
.mod-tag-text[data-tag="dexterity"] {
  background: rgba(55, 178, 77, 0.2);
  border-color: #37b24d;
  color: #37b24d;
}
.mod-tag-text[data-tag="minion"] {
  background: rgba(174, 62, 201, 0.2);
  border-color: #ae3ec9;
  color: #ae3ec9;
}
.mod-tag-text[data-tag="gem"] {
  background: rgba(16, 152, 173, 0.2);
  border-color: #1098ad;
  color: #1098ad;
}
.mod-tag-text[data-tag="aura"] {
  background: rgba(253, 126, 20, 0.2);
  border-color: #fd7e14;
  color: #fd7e14;
}
.mod-tag-text[data-tag="curse"] {
  background: rgba(103, 65, 217, 0.2);
  border-color: #6741d9;
  color: #6741d9;
}
.mod-tag-text[data-tag="ailment"] {
  background: rgba(247, 103, 7, 0.2);
  border-color: #f76707;
  color: #f76707;
}

/* Unavailable indicator and expand indicator */
.unavailable-indicator {
  color: #ffa500;
  font-size: 0.8rem;
  cursor: help;
  margin-right: 0.25rem;
}

.expand-indicator {
  color: #888;
  font-size: 0.7rem;
  margin-left: 0.25rem;
  user-select: none;
}

/* Tier details when expanded */
.mod-tier-details {
  background: #0f0f0f;
  border-top: 1px solid #333;
  padding: 0.5rem 0.75rem;
}

.tier-detail {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.25rem 0;
  font-size: 0.85rem;
  border-bottom: 1px solid #1a1a1a;
}

.tier-detail:last-child {
  border-bottom: none;
}

.tier-detail.unavailable {
  opacity: 0.5;
  color: #888;
}

.tier-label {
  font-weight: 600;
  color: #d4af37;
  min-width: 2rem;
}

.tier-stat {
  flex: 1;
  margin: 0 0.5rem;
  color: #e0e0e0;
}

.tier-values {
  color: #4dabf7;
  font-weight: 600;
  margin-right: 0.5rem;
  font-size: 0.85rem;
}

.tier-ilvl {
  color: #888;
  font-size: 0.8rem;
}

/* Enhanced hover effects for mod groups */
.pool-mod-group-header:hover {
  background: rgba(255, 255, 255, 0.05);
}

.mod-group-clickable {
  cursor: pointer;
  transition: all 0.2s ease;
}

.mod-group-clickable:hover {
  background: rgba(255, 255, 255, 0.08) !important;
  transform: translateY(-1px);
}

.pool-mod-group-header.prefix {
  border-left-color: #88ccff;
}

.pool-mod-group-header.suffix {
  border-left-color: #ffaa44;
}

.pool-mod-group-header.all-unavailable {
  opacity: 0.4;
  background: rgba(0, 0, 0, 0.2);
}

.pool-mod-group-header.all-unavailable .pool-mod-stat-main {
  color: #666;
  text-decoration: line-through;
  text-decoration-color: #ff6666;
}

.pool-mod-group-header.all-unavailable:hover {
  background: rgba(0, 0, 0, 0.3);
}

.group-main-info {
  flex: 1;
}

.group-summary {
  display: flex;
  gap: 0.75rem;
  margin-top: 0.5rem;
  align-items: center;
  flex-wrap: wrap;
}

.group-tier-range {
  font-size: 0.8rem;
  color: #888;
  padding: 0.2rem 0.6rem;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 3px;
  white-space: nowrap;
}

.group-tier-range.all-unavailable {
  color: #666;
  text-decoration: line-through;
  text-decoration-color: #ff6666;
}

.group-max-ilvl {
  font-size: 0.8rem;
  color: #d4af37;
  font-weight: 600;
  white-space: nowrap;
}

.unavailable-badge {
  font-size: 0.7rem;
  padding: 0.15rem 0.4rem;
  background: rgba(255, 102, 102, 0.15);
  border: 1px solid rgba(255, 102, 102, 0.3);
  border-radius: 3px;
  color: #ff6666;
  white-space: nowrap;
}

.unavailable-badge.all-unavailable {
  background: rgba(255, 102, 102, 0.25);
  border-color: rgba(255, 102, 102, 0.5);
  font-weight: 600;
}

.expand-indicator {
  font-size: 1.4rem;
  color: #888;
  font-weight: bold;
  min-width: 24px;
  width: 24px;
  height: 24px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.tier-breakdown {
  border-top: 1px solid #333;
  padding: 0.25rem 0;
}

.tier-item {
  padding: 0.25rem 0.5rem;
  border-left: 2px solid #333;
  margin-left: 0.5rem;
  margin-bottom: 0.25rem;
  transition: opacity 0.2s;
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.tier-item.unavailable {
  opacity: 0.5;
  cursor: not-allowed;
  position: relative;
}

.tier-item.unavailable .tier-range,
.tier-item.unavailable .tier-label {
  color: #666;
  text-decoration: line-through;
  text-decoration-thickness: 1.5px;
  text-decoration-color: #ff6666;
}

.tier-item.unavailable::before {
  content: '';
  position: absolute;
  left: 0;
  top: 50%;
  width: 100%;
  height: 1px;
  background: rgba(255, 102, 102, 0.3);
  transform: translateY(-50%);
  pointer-events: none;
}

.tier-header {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  flex: 1;
  min-width: 0;
}

.tier-label {
  font-size: 0.8rem;
  color: #e0e0e0;
  font-weight: 600;
}

.tier-ilvl {
  font-size: 0.7rem;
  color: #888;
}

.tier-ilvl.ilvl-too-high {
  color: #ff6666;
  font-weight: 600;
}

.tier-range {
  color: #d4af37;
  font-size: 0.75rem;
  font-weight: 500;
  flex-shrink: 0;
}

.tier-tags {
  display: flex;
  gap: 0.2rem;
  flex-wrap: wrap;
  flex: 0 0 auto;
}

.pool-mod-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 0.5rem;
  gap: 0.5rem;
}

.pool-mod-stat-main {
  font-weight: 500;
  color: #e0e0e0;
  font-size: 0.95rem;
  line-height: 1.4;
  flex: 1;
  min-width: 0;
  word-wrap: break-word;
}

.pool-mod-tier {
  font-size: 0.7rem;
  color: #888;
  padding: 0.15rem 0.4rem;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 3px;
  white-space: nowrap;
  margin-top: 0.1rem;
}

.pool-mod-range {
  color: #d4af37;
  font-size: 0.8rem;
  font-weight: 600;
  margin-bottom: 0.5rem;
}

.pool-mod-meta {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  flex-wrap: wrap;
}

.pool-mod-ilvl {
  font-size: 0.7rem;
  color: #666;
}

.pool-mod-tags {
  display: flex;
  gap: 0.25rem;
  flex-wrap: wrap;
}

.pool-tag {
  font-size: 0.6rem;
  padding: 0.1rem 0.3rem;
  background: rgba(100, 149, 237, 0.15);
  border: 1px solid rgba(100, 149, 237, 0.3);
  border-radius: 3px;
  color: #6495ed;
}

/* Omen greying out for incompatible mods */
.pool-mod-group.omen-incompatible {
  opacity: 0.3;
  filter: grayscale(50%);
}

.pool-mod-group.omen-incompatible .pool-mod-group-header {
  background: rgba(0, 0, 0, 0.2);
  border-left-color: #333;
  cursor: default;
}

.pool-mod-group.omen-incompatible .pool-mod-group-header:hover {
  background: rgba(0, 0, 0, 0.25);
}

.tier-item.omen-incompatible {
  opacity: 0.4;
  background: rgba(0, 0, 0, 0.1);
  border-left-color: #333;
}

.pool-mod-group.omen-incompatible .pool-mod-stat-main {
  color: #666;
}

.pool-mod-group.omen-incompatible .group-tier-range {
  background: rgba(0, 0, 0, 0.1);
  color: #666;
  border: 1px solid #333;
}

.pool-mod-group.omen-incompatible .pool-tag {
  background: rgba(0, 0, 0, 0.15);
  border: 1px solid #333;
  color: #666;
}

@media (max-width: 1400px) {
  .center-panel {
    min-width: 350px;
  }
}

@media (max-width: 1200px) {
  .simulator-layout {
    flex-direction: column;
  }

  .resize-handle {
    display: none;
  }

  .center-panel {
    margin-left: 0;
    min-width: unset;
  }

  .mods-pool-panel {
    max-height: 500px;
    width: 100% !important;
    max-width: 100%;
  }

  .mods-pool-columns {
    flex-direction: column;
  }

  .special-mods-columns {
    flex-direction: column;
  }

  .tag-legend-items {
    gap: 0.75rem;
  }

  .tag-legend-item {
    font-size: 0.8rem;
  }

  .currency-buttons-row {
    justify-content: center;
  }
}

/* Compact Currency Section Styles */
.currency-section-compact {
  background: #2a2a2a;
  border: 2px solid #444;
  border-radius: 8px;
  padding: 0.75rem;
  margin-bottom: 0.5rem;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.currency-section-compact .currency-buttons-grid {
  overflow-y: auto;
  padding-right: 8px;
}

.currency-section-compact .currency-buttons-grid::-webkit-scrollbar {
  width: 6px;
}

.currency-section-compact .currency-buttons-grid::-webkit-scrollbar-track {
  background: #1a1a1a;
  border-radius: 3px;
}

.currency-section-compact .currency-buttons-grid::-webkit-scrollbar-thumb {
  background: #444;
  border-radius: 3px;
}

.currency-section-compact .currency-buttons-grid::-webkit-scrollbar-thumb:hover {
  background: #555;
}

/* New currency layout styles */
.currency-layout-new {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  height: 100%;
}

.currency-section-horizontal {
  flex: 0 0 auto;
}

.currency-section-horizontal.bones-section {
  border: 1px solid #444;
  border-radius: 6px;
  padding: 0.5rem;
  background: rgba(101, 67, 33, 0.1);
}

.currency-horizontal-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-top: 0.5rem;
}

.currency-main-grid {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  flex: 1 1 auto;
  min-height: 0;
}

.currency-table.essences-wide {
  flex: 1 1 auto;
}

.essences-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-top: 0.5rem;
}

.essence-selector-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 48px;
  height: 48px;
  background: #444;
  border: 1px solid #666;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s;
  flex-direction: column;
  font-size: 0.7rem;
  color: #ccc;
}

.essence-selector-button:hover {
  background: #555;
  border-color: #888;
}

.essences-icon {
  font-size: 1.2rem;
  margin-bottom: 2px;
}

.essence-selector-text {
  font-size: 0.7rem;
}

.currency-section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.5rem;
  cursor: pointer;
  user-select: none;
  transition: background 0.2s;
  padding: 0.5rem;
  border-radius: 4px;
  margin: -0.5rem -0.5rem 0.5rem -0.5rem;
}

.currency-section-header:hover {
  background: rgba(255, 255, 255, 0.05);
}

.currency-section-header h3 {
  color: #d4af37;
  font-size: 1rem;
  margin: 0;
}

.undo-button-small {
  padding: 0.3rem 0.6rem;
  background: #444;
  color: white;
  border: none;
  border-radius: 4px;
  font-size: 0.8rem;
  cursor: pointer;
  transition: all 0.2s;
}

.undo-button-small:hover:not(:disabled) {
  background: #555;
}

.undo-button-small:disabled {
  opacity: 0.3;
  cursor: not-allowed;
}

.currency-buttons-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-bottom: 0.5rem;
  padding: 8px;
  background: rgba(0, 0, 0, 0.1);
  border-radius: 4px;
  border: 1px solid #333;
  max-height: 100%;
  overflow-y: auto;
}

.currency-button-icon {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: #2a2a2a;
  color: #e0e0e0;
  border: 1px solid #444;
  border-radius: 6px;
  font-size: 0.85rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  min-width: 140px;
  height: 40px;
  position: relative;
  box-sizing: border-box;
  white-space: nowrap;
}

.currency-button-icon:hover:not(:disabled) {
  background: #3a3a3a;
  border-color: #d4af37;
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(212, 175, 55, 0.2);
}

.currency-button-icon:disabled {
  opacity: 0.4;
  cursor: not-allowed;
  border-color: #333;
}

.currency-button-icon.currency-disabled {
  opacity: 0.4;
  background: #1a1a1a;
  border-color: #333;
  cursor: not-allowed;
  color: #666;
}

.currency-button-icon.currency-disabled:hover {
  background: #1a1a1a;
  border-color: #333;
  transform: none;
  box-shadow: none;
}

.currency-button-icon.currency-disabled .currency-icon-img {
  filter: grayscale(100%) brightness(0.5);
}

.currency-button-icon.currency-disabled .currency-name-short {
  color: #666;
}

.currency-icon {
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.currency-icon-img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  image-rendering: -webkit-optimize-contrast;
  image-rendering: crisp-edges;
}

.currency-name-short {
  font-size: 0.85rem;
  line-height: 1.2;
  color: inherit;
  flex: 1;
  text-align: left;
}

.no-currencies-compact {
  color: #666;
  font-size: 0.85rem;
  text-align: center;
  margin: 0;
  padding: 0.5rem;
}

.message-inline {
  padding: 0.4rem 0.6rem;
  border-radius: 4px;
  font-weight: 500;
  font-size: 0.8rem;
  text-align: center;
  margin-top: 0.25rem;
}

.message-inline.success {
  background: rgba(0, 255, 0, 0.1);
  border: 1px solid #00ff00;
  color: #00ff88;
}

.message-inline.error {
  background: rgba(255, 0, 0, 0.1);
  border: 1px solid #ff4444;
  color: #ff6666;
}

.message-inline.info {
  background: rgba(100, 149, 237, 0.1);
  border: 1px solid #6495ed;
  color: #87ceeb;
}


/* Currency Panel (Left Side) */
.currency-panel {
  border-right: 2px solid #444;
  padding-right: 0.75rem;
}

.currency-icon-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  justify-content: center;
}

.currency-icon-button {
  width: clamp(32px, 3vw, 40px);
  height: clamp(32px, 3vw, 40px);
  display: flex;
  align-items: center;
  justify-content: center;
  background: #1a1a1a;
  border: 2px solid #444;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
  flex-shrink: 0;
}

.currency-icon-button:hover {
  background: #2a2a2a;
  border-color: #666;
  transform: scale(1.1);
}

.currency-icon-button.currency-selected {
  border-color: #d4af37;
  background: rgba(212, 175, 55, 0.2);
  box-shadow: 0 0 10px rgba(212, 175, 55, 0.4);
}

.currency-icon-button.currency-disabled {
  opacity: 0.3;
  cursor: not-allowed;
}

.currency-icon-button.currency-disabled:hover {
  transform: none;
  background: #1a1a1a;
  border-color: #444;
}

.currency-icon-button .currency-icon-img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  padding: 4px;
}

.currency-category-tabs {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 1rem;
  border-bottom: 2px solid #444;
  padding-bottom: 0.5rem;
}

.category-tab {
  padding: 0.5rem 1rem;
  background: #2a2a2a;
  color: #aaa;
  border: 1px solid #444;
  border-radius: 6px 6px 0 0;
  cursor: pointer;
  font-weight: 500;
  font-size: 0.9rem;
  transition: all 0.2s;
}

.category-tab:hover {
  background: #333;
  color: #fff;
}

.category-tab.active {
  background: #d4af37;
  color: #000;
  border-color: #d4af37;
}

/* Currency Selected State */
.currency-button-icon.currency-selected {
  border: 2px solid #d4af37;
  background: rgba(212, 175, 55, 0.1);
}

.currency-button-icon.currency-selected:hover {
  background: rgba(212, 175, 55, 0.2);
}

/* Omen states for currency-icon-button-small when used as omens */
.currency-icon-button-small.omen-active {
  background: rgba(74, 158, 255, 0.2);
  border-color: #4a9eff;
  box-shadow: 0 0 10px rgba(74, 158, 255, 0.3);
}

.currency-icon-button-small.omen-active:hover {
  background: rgba(74, 158, 255, 0.3);
}

.currency-icon-button-small.omen-incompatible {
  opacity: 0.3;
  cursor: not-allowed;
}

.currency-icon-button-small.omen-incompatible:hover {
  transform: none;
  background: #1a1a1a;
  border-color: #444;
}

.omen-active-indicator {
  position: absolute;
  top: 4px;
  right: 4px;
  background: #4a9eff;
  color: #fff;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.75rem;
  font-weight: bold;
}

.no-omens-message {
  text-align: center;
  color: #666;
  font-style: italic;
  margin: 2rem 0;
}

.selected-omens-info {
  padding: 0.5rem;
  background: rgba(74, 158, 255, 0.1);
  border: 1px solid #4a9eff;
  border-radius: 4px;
  color: #87ceeb;
  font-size: 0.85rem;
  text-align: center;
}

.selected-omens-info strong {
  color: #4a9eff;
}

/* Omen grouping styles - 2-column layout */
.omen-table .currency-horizontal-rows {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.omen-group {
  margin-bottom: 0.25rem;
}

.omen-group-label {
  display: block;
  font-size: 0.65rem;
  color: #9370db;
  font-weight: 600;
  text-align: center;
  margin-bottom: 0.125rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  line-height: 1;
}

.omen-group .currency-family-row {
  justify-content: center;
  border: 1px solid rgba(106, 90, 205, 0.2);
  border-radius: 4px;
  padding: 0.15rem;
  background: rgba(106, 90, 205, 0.05);
  gap: 0.2rem;
}

/* Compact mobile design for omens */
@media (max-width: 768px) {
  .omen-group {
    margin-bottom: 0.2rem;
  }

  .omen-group-label {
    font-size: 0.6rem;
    margin-bottom: 0.1rem;
  }

  .omen-group .currency-family-row {
    padding: 0.1rem;
    gap: 0.15rem;
  }
}

/* Apply Currency Button */
.apply-currency-section {
  margin-top: 1rem;
  display: flex;
  justify-content: center;
}

.apply-currency-button {
  padding: 0.75rem 1.5rem;
  background: #00ff88;
  color: #000;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  font-size: 1rem;
  transition: all 0.2s;
  box-shadow: 0 2px 8px rgba(0, 255, 136, 0.3);
}

.apply-currency-button:hover:not(:disabled) {
  background: #00ffaa;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 255, 136, 0.4);
}

.apply-currency-button:disabled {
  background: #333;
  color: #666;
  cursor: not-allowed;
  box-shadow: none;
}

/* Currency five tables layout */
.currency-five-tables {
  display: flex;
  gap: 0.5rem;
  align-items: flex-start;
  flex-wrap: wrap;
  justify-content: center;
}

.currency-table {
  flex: 1 1 auto;
  min-width: 120px;
  max-width: 200px;
}

.currency-table-title {
  color: #d4af37;
  font-size: 0.85rem;
  font-weight: 500;
  margin: 0 0 0.5rem 0;
  text-align: center;
}

/* Special styling for omen table */
.omen-table {
  border: 2px solid #6a5acd;
  background: rgba(106, 90, 205, 0.1);
  border-radius: 8px;
}

.omen-table .currency-table-title {
  color: #9370db;
}

/* Currency horizontal rows layout styles */
.currency-horizontal-rows {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.currency-family-row {
  display: flex;
  gap: 0.25rem;
  align-items: center;
  justify-content: center;
  flex-wrap: wrap;
}

/* Ensure essence rows display horizontally */
.currency-table .currency-horizontal-rows .currency-family-row {
  display: flex !important;
  flex-direction: row !important;
  align-items: center;
  justify-content: flex-start;
  gap: 0.25rem;
  flex-wrap: wrap;
}

.currency-row-gap {
  height: 0.5rem;
}

.currency-empty-slot {
  width: 48px;
  height: 48px;
  border: 2px dashed #333;
  border-radius: 8px;
  background: transparent;
}

.additional-currencies {
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px solid #444;
}

.currency-category-section {
  margin-bottom: 1rem;
}

.currency-category-title {
  color: #d4af37;
  font-size: 0.9rem;
  margin: 0 0 0.5rem 0;
  font-weight: 500;
}

.currency-icon-grid-compact {
  display: flex;
  flex-wrap: wrap;
  gap: 0.2rem;
  justify-content: center;
}

.currency-icon-button-small {
  width: clamp(32px, 3vw, 40px);
  height: clamp(32px, 3vw, 40px);
  display: flex;
  align-items: center;
  justify-content: center;
  background: #1a1a1a;
  border: 1px solid #444;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
}

.currency-icon-button-small:hover {
  background: #2a2a2a;
  border-color: #666;
  transform: scale(1.1);
}

.currency-icon-button-small.currency-selected {
  border-color: #d4af37;
  background: rgba(212, 175, 55, 0.2);
  box-shadow: 0 0 8px rgba(212, 175, 55, 0.4);
}

.currency-icon-button-small.currency-disabled {
  opacity: 0.3;
  cursor: not-allowed;
}

.currency-icon-button-small.currency-disabled:hover {
  transform: none;
  background: #1a1a1a;
  border-color: #444;
}

.currency-icon-img-small {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

/* Responsive adjustments for compact currency layout */
@media (max-width: 800px) {

  .currency-icon-grid {
    /* Already using flexbox, no changes needed */
  }

  .currency-icon-button,
  .currency-icon-button-small {
    width: 36px;
    height: 36px;
  }

  .currency-five-tables {
    flex-direction: column;
    gap: 1rem;
  }

  .currency-horizontal-rows {
    align-items: center;
  }

  .currency-family-row {
    justify-content: center;
    gap: 0.25rem;
  }

  .currency-empty-slot {
    width: 40px;
    height: 40px;
  }

  .currency-icon-grid-compact {
    /* Already using flexbox, no changes needed */
  }

  .currency-icon-button-small {
    width: 28px;
    height: 28px;
  }
}

/* 3-Column Essence Stash Layout */
.essence-stash-layout {
  display: flex;
  gap: 2rem;
  width: fit-content;
  align-items: start;
  justify-content: center;
  margin: 0 auto;
  flex-wrap: wrap;
}

.essence-column-1,
.essence-column-3 {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  min-width: 0;
}

.essence-column-2 {
  display: flex;
  align-items: flex-start;
  justify-content: center;
  min-width: 120px;
  padding-top: 0;
}

.essence-type-row {
  display: flex;
  flex-direction: row;
  gap: 0.25rem;
}

/* Corrupted essences layout */
.corrupted-essences {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

.corrupted-row {
  display: flex;
  gap: 0.25rem;
}

.abyss-row {
  justify-content: center;
}

/* Essence Section Styling */
.essence-section {
  margin-top: 0.5rem;
}

.essences-button {
  position: relative;
  width: 50px;
  height: 50px;
  background: linear-gradient(135deg, #4a148c 0%, #6a1b9a 100%);
  border: 2px solid #8e24aa;
  border-radius: 8px;
  color: #fff;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 2px 8px rgba(74, 20, 140, 0.3);
}

.essences-button:hover {
  background: linear-gradient(135deg, #5e1fa3 0%, #7b1fa2 100%);
  border-color: #9c27b0;
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(74, 20, 140, 0.5);
}

.essences-icon {
  font-size: 1.5rem;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
}

.expand-indicator {
  position: absolute;
  bottom: 2px;
  right: 2px;
  background: rgba(255, 255, 255, 0.9);
  color: #4a148c;
  font-size: 0.75rem;
  font-weight: bold;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

/* Essence Placeholder Button */
.essence-placeholder-button {
  width: 50px;
  height: 50px;
  background: linear-gradient(135deg, #4a148c 0%, #6a1b9a 100%);
  border: 2px solid #8e24aa;
  border-radius: 8px;
  color: #fff;
  transition: all 0.2s;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 2px;
  box-shadow: 0 2px 8px rgba(74, 20, 140, 0.3);
  position: relative;
}

.essence-placeholder-button:hover {
  background: linear-gradient(135deg, #5e1fa3 0%, #7b1fa2 100%);
  border-color: #9c27b0;
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(74, 20, 140, 0.5);
}

.essence-placeholder-button .essences-icon {
  font-size: 1.2rem;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
}

.essence-placeholder-text {
  font-size: 0.65rem;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  opacity: 0.9;
}

.essence-expand-arrow {
  position: absolute;
  bottom: 2px;
  right: 2px;
  width: 16px;
  height: 16px;
  background: rgba(0, 0, 0, 0.6);
  border: 1px solid rgba(255, 255, 255, 0.3);
  border-radius: 3px;
  color: #fff;
  font-size: 8px;
  line-height: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s;
  backdrop-filter: blur(2px);
}

.essence-expand-arrow:hover {
  background: rgba(0, 0, 0, 0.8);
  border-color: rgba(255, 255, 255, 0.6);
  transform: scale(1.1);
}

.essence-selector-row {
  min-height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Essence Modal */
.essence-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.85);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  animation: fadeIn 0.2s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.essence-modal {
  background: #1a1a1a;
  border: 2px solid #8e24aa;
  border-radius: 12px;
  width: fit-content;
  max-width: 90vw;
  max-height: 90vh;
  display: flex;
  flex-direction: column;
  box-shadow: 0 8px 32px rgba(142, 36, 170, 0.4);
  animation: slideUp 0.3s ease-out;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.essence-modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1.5rem 2rem;
  border-bottom: 2px solid #8e24aa;
  background: linear-gradient(135deg, #2a0845 0%, #4a148c 100%);
}

.essence-modal-header h2 {
  color: #d4af37;
  margin: 0;
  font-size: 1.5rem;
}

.essence-modal-close {
  background: none;
  border: none;
  color: #fff;
  font-size: 2rem;
  cursor: pointer;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 4px;
  transition: background-color 0.2s;
}

.essence-modal-close:hover {
  background: rgba(255, 255, 255, 0.1);
}

.essence-modal-content {
  padding: 2rem;
  overflow-y: auto;
  flex: 1;
}

.essence-modal-content .essence-stash-layout {
  margin: 0;
}

/* Very narrow screens - single column layout */
@media (max-width: 600px) {
  .mods-pool-columns,
  .special-mods-columns {
    flex-direction: column;
    gap: 0.5rem;
  }

  .special-column-title {
    font-size: 0.9rem;
    padding: 0.4rem;
  }

  .tag-legend-items {
    gap: 0.5rem;
  }

  .tag-legend-item {
    font-size: 0.75rem;
  }

  .tag-legend h4 {
    font-size: 0.9rem;
  }
}